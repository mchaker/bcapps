<script src="../bclib.js"></script>

<canvas id="thefonz" width="800" height="600"></canvas>


<script>

let png = 'iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAElBMVEVAygOW4HdEvwQ8zQA9ywRBygBw60gpAAABAUlEQVR4nO3PARGAMAwAsQKdf8vo+F3iIPO8387ZPXMrwz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+wz7DPsM+w7wfv64YnTVjj7gAAAAASUVORK5CYII=';


let data = fetch('http://test.barrycarter.info/bc-cors-test.pl').then
   (function (x) {return x.arrayBuffer();}).then
   (function (y) {datahandle(new DataView(y));});

function datahandle(z) {
  //  for (let i=0 ; i<z.byteLength; i++) {
  //    console.log(i, z.getUint8(i));
  //  }
}

let fonz = document.getElementById('thefonz');
ctx = fonz.getContext('2d');

let myImageData = ctx.createImageData(fonz.width, fonz.height);

for (i=0; i < myImageData.data.length; i++) {
  myImageData.data[i] = Math.floor(Math.random()*256);
 }

ctx.putImageData(myImageData, 0, 0);


// for (i=0; i<=240000; i++) {
//  x = Math.floor(Math.random()*1600);
//  y = Math.floor(Math.random()*900);
//  ctx.fillRect(x,y,1,1);
// }


console.log(myImageData);



</script>
